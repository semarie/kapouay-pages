<!doctype html><html lang=en><head><meta charset=utf-8><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0" name=viewport><title>AT protocol / bluesky from scratch - Handle - kapouay.eu.org</title><link href=/style.css rel=stylesheet><link href=/favicon.ico rel=icon><link href=/atom.xml rel=alternate type=application/atom+xml><link href=https://maly.io/@semarie rel=me><meta content=article property=og:type><meta content="AT protocol / bluesky from scratch - Handle" property=og:title><body><nav class=site><ul><li><a href=/>About</a><li><a href=/notes/>Notes</a><li><a href=/bookmarks/>Bookmarks</a><li><a href=/tags>Tags</a></ul></nav><article><header><h1>AT protocol / bluesky from scratch - Handle</h1><ul class=properties><li>Published on 2023-08-22 by Sebastien Marie<li>Reading time: 2 minutes</li><a href=/tags/atproto/>#atproto</a></ul></header><nav class=toc><h1>Table of contents</h1><ul><li><a href=/notes/atproto-handle/#handle>Handle</a> <ul><li><a href=/notes/atproto-handle/#dns-txt-record>DNS TXT record</a><li><a href=/notes/atproto-handle/#https-dns-well-known-record>HTTPS (+ DNS) well-known record</a></ul><li><a href=/notes/atproto-handle/#some-remarks>Some remarks</a></ul></nav><section><p>Let's look at the <a href=https://atproto.com/>AT protocol</a> starting from scratch, with just an handle <code>semarie.bsky.social</code>.<h1 id=handle>Handle</h1><p>The <a href=https://atproto.com/specs/handle>handle</a> is just a name for humans. It is first resolved to a <a href=https://en.wikipedia.org/wiki/Decentralized_identifier>Decentralized Identifiers</a> (DID).<p>It is just an resolvable hostname (resolvable to some extent as we will see).<pre><code>$ dig +short semarie.bsky.social
44.216.73.82
34.197.208.36
52.22.43.240
$ 
</code></pre><p>In fact, there is two differents supported methods to resolv the handle to DID identifier.<h2 id=dns-txt-record>DNS TXT record</h2><p>The first one to test is to try resolv <code>_atproto.semarie.bsky.social</code> to get a <code>TXT</code> record.<pre><code>$ dig +short _atproto.semarie.bsky.social TXT
$ 
</code></pre><p>Ah, there is no result. So we will test the second method. But let's see first the result for an handle using DNS TXT.<pre><code>$ dig +short _atproto.semarie.kapouay.eu.org TXT
"did=did:plc:26sw3p6ebn4p6fn5otobufyn"
$ 
</code></pre><p>And we get the DID identifier (<code>did:plc:26sw3p6ebn4p6fn5otobufyn</code>).<h2 id=https-dns-well-known-record>HTTPS (+ DNS) well-known record</h2><p>The second method uses HTTPS. So it needs a HTTP server (with proper certificateâ€¦), and so a valid IP address to contact it. As seen with <code>semarie.bsky.social</code>, the handle resolves to IPv4 addresses (but no IPv6 address at the time).<p>The DID is obtained from getting the document at <code>https://HANDLE/.well-known/atproto-did</code>.<pre><code>$ curl -s https://semarie.bsky.social/.well-known/atproto-did
did:plc:26sw3p6ebn4p6fn5otobufyn
$ 
</code></pre><p>And we get the DID identifier (<code>did:plc:26sw3p6ebn4p6fn5otobufyn</code>).<h1 id=some-remarks>Some remarks</h1><ul><li>Anybody could place an handle to any DID identifier, even if not "owning" it. <ul><li>AT protocol asks to resolve the DID identifier to DID document (we will see that later), and to check back the handle in the DID document.</ul><li>The handle is an hostname <ul><li>there is some size restriction on hostname, but it could be a long name (up to 253 characters with <code>.</code>)<li>the allowed characters in hostname could be tricky, and leads to differences in implementations <ul><li>in original <a href=https://www.rfc-editor.org/std/std13.txt>STD-13</a>, the Name space specifications is just "octet" (so any character)<li>usually only ASCII <code>[a-z0-9-]</code> are used<li>but <code>_</code> could be found too<li>and <a href=https://en.wikipedia.org/wiki/Internationalized_domain_name>internationalized domain names</a> makes most of Unicode available (via a transformation) <ul><li>so at least a presentation question in interface</ul></ul></ul></ul></section><footer></footer></article>